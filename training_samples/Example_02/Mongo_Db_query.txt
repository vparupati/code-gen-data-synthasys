// MongoDB collections are created automatically on first insert
// However, we can create indexes to define the structure

// Create indexes for institutions collection
db.institutions.createIndex({ bic: 1 }, { name: "by_bic", unique: true, partialFilterExpression: { bic: { $exists: true } } });
db.institutions.createIndex({ lei: 1 }, { name: "by_lei", unique: true, partialFilterExpression: { lei: { $exists: true } } });

// Create indexes for parties collection
db.parties.createIndex({ display_name: 1 }, { name: "by_name" });
db.parties.createIndex({ "identifiers.value": 1 }, { name: "by_identifier_value" });

// Create indexes for messages collection
db.messages.createIndex({ external_ref: 1 }, { name: "uq_external_ref", unique: true });
db.messages.createIndex({ current_state: 1, last_state_changed_at: -1 }, { name: "state_recent" });

// Create indexes for payments collection
db.payments.createIndex({ payment_ref: 1 }, { name: "uq_payment_ref", unique: true });
db.payments.createIndex({ message_id: 1 }, { name: "by_message" });
db.payments.createIndex({ scheme: 1, created_at: -1 }, { name: "by_scheme_created" });
db.payments.createIndex({ current_state: 1, last_state_changed_at: -1 }, { name: "state_recent" });
db.payments.createIndex({ "state_history.occurred_at": -1 }, { name: "hist_time" });

